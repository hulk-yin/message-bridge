---
name: message-bridge
description: AI æ™ºèƒ½ä½“æ¶ˆæ¯æ¡¥æ¢ï¼Œè¿æ¥é£ä¹¦/é’‰é’‰/ä¼å¾®ï¼Œå®ç°å¼‚æ­¥é€šçŸ¥ä¸ç¡®è®¤ã€‚å‘é€æ¶ˆæ¯åˆ°é£ä¹¦ç¾¤ã€ç­‰å¾…ç”¨æˆ·å›å¤ã€ä¼šè¯åˆ‡æ¢åˆ°é£ä¹¦ã€‚åœ¨ç”¨æˆ·æåˆ°é£ä¹¦ã€é’‰é’‰ã€ä¼å¾®ã€æ¶ˆæ¯é€šçŸ¥ã€å®¡æ‰¹ç¡®è®¤ã€ä¼šè¯åˆ‡æ¢æ—¶ä½¿ç”¨ã€‚
---

# MessageBridge Skillï¼ˆé’é¸Ÿï¼‰

AI æ™ºèƒ½ä½“çš„æ¶ˆæ¯æ¡¥æ¢ï¼Œè¿æ¥é£ä¹¦/é’‰é’‰/ä¼å¾®ï¼Œå®ç°å¼‚æ­¥é€šçŸ¥ä¸ç¡®è®¤ã€‚**å¯¹å¤–å¯ç§°ã€Œé’é¸Ÿã€**ï¼ŒæŠ€æœ¯åä¸åŒ…åä»ä¸º `skill-message-bridge`ã€‚

**å¯¹å¤–å”¯ä¸€ç”¨æ³•**ï¼š**æ— éœ€å®‰è£…**ï¼Œå‘å†…å®¹åˆ°é£ä¹¦å¹¶ç­‰å›å¤åªéœ€ä¸€æ¡å‘½ä»¤ï¼Œä¼šè¯åˆ‡æ¢æ—¶å¾ªç¯è°ƒç”¨åŒä¸€æ¡ï¼š

```bash
npx skill-message-bridge "<å†…å®¹>"
# å¯é€‰è¶…æ—¶ï¼šnpx skill-message-bridge "<å†…å®¹>" --timeout=3600
```

å…¶ä½™ï¼ˆè‡ªæ£€ã€é…ç½®ã€é¦–æ¬¡é…å¯¹ç­‰ï¼‰éƒ½æ˜¯è¯¥å‘½ä»¤çš„**å†…éƒ¨é€»è¾‘**ï¼Œè§ä¸‹æ–‡ã€Œå‘½ä»¤å†…éƒ¨é€»è¾‘ä¸é…ç½®ã€ã€‚éœ€åœ¨ Cursor/Codex å†…åšã€Œä¼šè¯åˆ‡æ¢é£ä¹¦ã€é—­ç¯æ—¶ï¼Œå¯å°†æœ¬ä»“å…‹éš†åˆ° skill ç›®å½•å¹¶æ‰§è¡Œ `npm run turn -- "<å†…å®¹>"`ã€‚å®‰è£…æ–¹å¼è§ [INSTALL.md](./INSTALL.md)ã€‚

## Quick Start

**æ— éœ€ `npm install`**ï¼Œä»»æ„ç›®å½•æ‰§è¡Œï¼ˆnpx ä¼šä» npm æ‹‰å–å¹¶è¿è¡Œï¼‰ï¼š

```bash
npx skill-message-bridge "<è¦å‘åˆ°é£ä¹¦çš„å†…å®¹>"
```

- æŠŠå†…å®¹å‘åˆ°é£ä¹¦å¹¶ç­‰å¾…ç”¨æˆ·å›å¤ï¼›stdout è¾“å‡ºå•è¡Œ JSONï¼ˆ`status`ã€`reply`ã€`sessionHint` ç­‰ï¼‰ã€‚
- ã€Œåˆ°é£ä¹¦ã€/ ä¼šè¯åˆ‡æ¢ï¼šå¾ªç¯æ‰§è¡Œã€ŒAI ç”Ÿæˆå›å¤ â†’ `npx skill-message-bridge "<å†…å®¹>"` â†’ è§£æå›å¤ â†’ å†ç”Ÿæˆ â†’ å†è°ƒç”¨ã€ï¼Œç›´åˆ°ç”¨æˆ·è¯´ã€Œç»“æŸã€æˆ–ã€Œåˆ‡å›ã€ã€‚
- è‹¥æœªé…ç½®é£ä¹¦ï¼Œå‘½ä»¤å†…éƒ¨ä¼šè‡ªæ£€å¹¶ç»™å‡ºå¼•å¯¼ï¼ŒæŒ‰æç¤ºå®Œæˆé…ç½®åå†ç”¨åŒä¸€æ¡å‘½ä»¤å³å¯ï¼ˆé…ç½®ä¸é¦–æ¬¡é…å¯¹è§ä¸‹æ–‡ã€Œå‘½ä»¤å†…éƒ¨é€»è¾‘ä¸é…ç½®ã€ï¼‰ã€‚

## 1. Skill é…ç½®

- **åŒ…å**ï¼š`skill-message-bridge`ã€‚
- **å¯¹å¤–ç”¨æ³•**ï¼š`npx skill-message-bridge "<å†…å®¹>"`ï¼ˆå‘åˆ°é£ä¹¦å¹¶ç­‰å›å¤ï¼‰ï¼›è‡ªæ£€ã€configã€connect ç­‰ä¸ºå‘½ä»¤å†…éƒ¨é€»è¾‘ï¼Œè§ Â§4.2ã€‚
- **é£ä¹¦é…ç½®**ï¼šç¯å¢ƒå˜é‡æˆ– `~/.message-bridge/config.json`ï¼›å®Œæ•´å¼•å¯¼è§ [é£ä¹¦ Onboarding](./docs/ONBOARDING-FEISHU.md)ã€‚

## 2. åŠŸèƒ½

- âœ… å‘é€æ¶ˆæ¯åˆ°é£ä¹¦ç¾¤èŠ
- âœ… å‘é€æ¶ˆæ¯å¹¶ç­‰å¾…ç”¨æˆ·å›å¤
- âœ… é•¿è¿æ¥å®æ—¶æ¥æ”¶ï¼ˆé£ä¹¦äº‹ä»¶è®¢é˜…ï¼‰
- âœ… è¶…æ—¶å¤„ç†
- âœ… ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†

## 3. Channel é…ç½®æ€»è§ˆ

| Channel | çŠ¶æ€ | ç¯å¢ƒå˜é‡ | è¯´æ˜ä¸æ–‡æ¡£ |
|--------|------|----------|------------|
| **é£ä¹¦ Feishu** | âœ… å·²æ”¯æŒ | `FEISHU_APP_ID`ã€`FEISHU_APP_SECRET`ã€`FEISHU_CHAT_ID`ï¼ˆæˆ– `DITING_FEISHU_*`ï¼‰ | é•¿è¿æ¥æ”¶æ¶ˆæ¯ï¼›å®Œæ•´ä»åˆ›å»ºåº”ç”¨åˆ°è·å– chat_id è§ [é£ä¹¦ Onboarding](./docs/ONBOARDING-FEISHU.md) |
| é’‰é’‰ DingTalk | ğŸ“Œ è§„åˆ’ä¸­ | ï¼ˆå¾…å®šï¼‰ | è§ [CONTRIBUTING.md](./CONTRIBUTING.md#äºŒæ–°æ¸ é“æ¥å…¥--adding-a-new-channel) |
| ä¼å¾® WeCom | ğŸ“Œ è§„åˆ’ä¸­ | ï¼ˆå¾…å®šï¼‰ | åŒä¸Š |

å½“å‰ä»…é£ä¹¦å¯ç”¨ï¼›é’‰é’‰/ä¼å¾®æ¬¢è¿æŒ‰ CONTRIBUTING æ¥å…¥ã€‚

## 4. ä½¿ç”¨æ–¹å¼

### 4.1 å¯¹å¤–å”¯ä¸€ç”¨æ³•ï¼ˆAI / è°ƒç”¨æ–¹åªè®¤è¿™ä¸€æ¡ï¼‰

```bash
npx skill-message-bridge "<å†…å®¹>"
npx skill-message-bridge "<å†…å®¹>" --timeout=3600   # å¯é€‰ï¼šå•è½®è¶…æ—¶ç§’æ•°
```

- æŠŠ `<å†…å®¹>` å‘åˆ°é£ä¹¦å¹¶ç­‰å¾…ç”¨æˆ·å›å¤ï¼›**stdout ä»…è¾“å‡ºä¸€è¡Œ JSON**ï¼ˆ`status`ã€`reply`ã€`replyUser`ã€`sessionHint` ç­‰ï¼‰ï¼Œä¾¿äº agent è§£æã€é¿å…å†å²å™ªéŸ³ï¼›[MessageBridge] ç­‰æ—¥å¿—åœ¨ stderrï¼Œè§£ææ—¶åªè®¤ stdout è¯¥è¡Œ JSON å³å¯ã€‚
- æ¶ˆæ¯ä¹Ÿå¯ä» stdin ä¼ å…¥ï¼š`echo "å†…å®¹" | npx skill-message-bridge`ã€‚
- **ã€Œåˆ°é£ä¹¦ã€/ ä¼šè¯åˆ‡æ¢**ï¼šåªå¾ªç¯è°ƒç”¨è¿™ä¸€æ¡å‘½ä»¤ï¼Œç”± AI ç»´æŒä¼šè¯ï¼Œç›´åˆ°ç”¨æˆ·è¯´ã€Œç»“æŸã€æˆ–ã€Œåˆ‡å›ã€ã€‚

ä¸è¦ä½¿ç”¨ `require("@skills/message-bridge")`ï¼ˆåŒ…åä¸º `skill-message-bridge`ï¼‰ã€‚

### 4.2 å‘½ä»¤å†…éƒ¨é€»è¾‘ä¸é…ç½®ï¼ˆéå¯¹å¤–ç”¨æ³•ï¼‰

ä»¥ä¸‹å‡ä¸º**å‘½ä»¤å†…éƒ¨**æˆ–**ç”¨æˆ·é¦–æ¬¡é…ç½®**æ—¶æ¶‰åŠçš„è¡Œä¸ºï¼ŒAI ä¸éœ€è¦æ ¹æ®åœºæ™¯é€‰æ‹©ã€Œç”¨ check-env è¿˜æ˜¯ connect è¿˜æ˜¯ sendã€ï¼›åªéœ€ç”¨ `npx skill-message-bridge "<å†…å®¹>"`ï¼Œæœªé…ç½®æ—¶å‘½ä»¤ä¼šè‡ªæ£€å¹¶ç»™å‡ºå¼•å¯¼ã€‚

| å†…éƒ¨/é…ç½®ç”¨é€” | è¯´æ˜ |
|---------------|------|
| **è‡ªæ£€** | å‘½ä»¤æ‰§è¡Œæ—¶ä¼šæ£€æŸ¥ç¯å¢ƒå˜é‡æˆ– `~/.message-bridge/config.json`ï¼›ç¼ºé¡¹æ—¶è¾“å‡ºå¼•å¯¼ï¼Œä¸ç›´æ¥å‘æ¶ˆæ¯ã€‚ |
| **å†™å…¥é…ç½®** | ç”¨æˆ·é¦–æ¬¡é…ç½®ï¼š`npx skill-message-bridge config set feishu --app-id=xxx --app-secret=xxx` å†™å…¥é…ç½®æ–‡ä»¶ï¼›äº¤äº’å¼å¼•å¯¼éœ€ç”¨æˆ·**æœ¬æœºç»ˆç«¯**æ‰§è¡Œï¼ˆTTYï¼‰ï¼Œnpx ä»£è·‘å¤šä¸ºé TTYã€‚ |
| **é¦–æ¬¡é…å¯¹ï¼ˆchat_idï¼‰** | ä»…ç¼º Chat ID æ—¶ï¼šç”¨æˆ·åœ¨æœ¬æœºç»ˆç«¯æ‰§è¡Œ `npx skill-message-bridge connect`ï¼Œåœ¨é£ä¹¦å‘ä¸€æ¡æ¶ˆæ¯åç»ˆç«¯è¾“å‡º chat_idï¼Œå†æ‰§è¡Œ `config set feishu --chat-id=oc_xxx` ä¿å­˜ã€‚**connect ä»…ç”¨äºæ­¤æ¬¡é…å¯¹**ï¼ŒAI åœ¨ã€Œåˆ°é£ä¹¦ã€æ—¶**ä¸è¦**è°ƒç”¨ connectï¼Œåªå¾ªç¯è°ƒç”¨ `npx skill-message-bridge "<å†…å®¹>"`ã€‚ |
| **ä»…å‘ä¸ç­‰** | å†…éƒ¨å¯¹åº” `send` å­å‘½ä»¤ï¼›å¯¹å¤–ç»Ÿä¸€ç”¨ã€Œå‘å†…å®¹å¹¶ç­‰å›å¤ã€è¿™ä¸€æ¡å³å¯ï¼Œéœ€è¦ã€Œåªå‘ä¸ç­‰ã€æ—¶å¯ç”±è°ƒç”¨æ–¹å‘å®Œå³å¿½ç•¥å›å¤æˆ–è®¾æçŸ­è¶…æ—¶ã€‚ |
| **å¿ƒè·³ï¼ˆ--heartbeatï¼‰** | ä»…ç­‰å¾…é£ä¹¦ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼Œ**ä¸å‘é£ä¹¦æ¨é€ä»»ä½•å†…å®¹**ï¼›ç”¨äºå•è½®è¶…æ—¶å**æŠŠä¼šè¯é‡æ–°æ‹‰èµ·**ã€ç»§ç»­ç­‰é£ä¹¦ã€‚ç”¨æ³•ï¼š`npx skill-message-bridge --heartbeat [--timeout=N]`ã€‚ä¼šè¯æ°¸ä¸å› è¶…æ—¶é€€å‡ºï¼Œè¶…æ—¶åå¿…é¡»ç”¨å¿ƒè·³æ‹‰èµ·ã€‚è¾“å‡ºæ ¼å¼ä¸ `"<å†…å®¹>"` ä¸€è‡´ï¼ˆå•è¡Œ JSON + sessionHintï¼‰ï¼Œè¶…æ—¶åŒæ ·ä¸º `status:"timeout"`ã€‚ |
| **å¸®åŠ©** | `npx skill-message-bridge --help`ã€`config show`ã€`config path` ç­‰ä¸ºè°ƒè¯•/è¿ç»´ç”¨ï¼Œéä¼šè¯é—­ç¯æ‰€éœ€ã€‚ |

å®Œæ•´é£ä¹¦é…ç½®ä¸æƒé™æ­¥éª¤è§ [é£ä¹¦ Onboarding](./docs/ONBOARDING-FEISHU.md)ã€‚

### 4.3 åœ¨ä»£ç ä¸­è°ƒç”¨ï¼ˆå¯é€‰ï¼‰

éœ€è¦åœ¨è‡ªå·±å†™çš„ Node è„šæœ¬é‡Œè°ƒç”¨æ—¶ï¼Œå¯å®‰è£…å requireï¼š

```bash
npm install skill-message-bridge
```

```javascript
const messageBridge = require("skill-message-bridge");
// æˆ–åœ¨æœ¬ä»“åº“æ ¹ç›®å½•å¼€å‘æ—¶: require("./dist/index.js")ï¼ˆéœ€å…ˆ npm run buildï¼‰
```

### 4.4 ç¯å¢ƒå˜é‡ï¼ˆé£ä¹¦ï¼‰

```bash
export FEISHU_APP_ID="cli_xxx"
export FEISHU_APP_SECRET="xxx"
export FEISHU_CHAT_ID="oc_xxx"
```

ï¼ˆä¹Ÿæ”¯æŒ `DITING_FEISHU_*`ã€‚å¦‚ä½•è·å– chat_id è§ [é£ä¹¦ Onboarding](./docs/ONBOARDING-FEISHU.md)ã€‚ï¼‰

### 4.5 åœ¨ Node.js ä¸­ä½¿ç”¨

```javascript
const messageBridge = require("skill-message-bridge");   // ä» npm å®‰è£…æ—¶
// æˆ– const messageBridge = require("./dist/index.js");  // åœ¨æœ¬ä»“åº“æ ¹ç›®å½•æ—¶ï¼ˆéœ€å…ˆ npm run buildï¼‰

// å‘é€æ¶ˆæ¯å¹¶ç­‰å¾…å›å¤
const result = await messageBridge.notify({
  message: "éœ€è¦ä½ ç¡®è®¤ä¸€ä¸‹è¿™ä¸ªæ“ä½œ",
  timeout: 60,
});

if (result.status === "replied") {
  console.log("ç”¨æˆ·å›å¤:", result.reply);
} else if (result.status === "timeout") {
  console.log("è¶…æ—¶æœªå›å¤");
}

await messageBridge.send({ message: "ä»»åŠ¡å·²å®Œæˆï¼" });
```

### 4.6 åœ¨ OpenClaw / å…¶ä»– AI æ™ºèƒ½ä½“ä¸­

```javascript
const { notify, send } = require("skill-message-bridge");

const result = await notify({
  message: "æ£€æµ‹åˆ°å¼‚å¸¸ï¼Œæ˜¯å¦ç»§ç»­ï¼Ÿ",
  timeout: 120,
});

if (result.status === "replied" && result.reply.includes("ç»§ç»­")) {
  console.log("ç”¨æˆ·ç¡®è®¤ï¼Œç»§ç»­æ‰§è¡Œ");
} else {
  console.log("ç”¨æˆ·æ‹’ç»æˆ–è¶…æ—¶ï¼Œåœæ­¢æ‰§è¡Œ");
}
```

## API æ‘˜è¦

- **notify({ message, timeout? })**ï¼šå‘æ¶ˆæ¯å¹¶ç­‰å¾…ç”¨æˆ·å›å¤ï¼›è¿”å› `status: "replied"|"timeout"|"error"`ã€`reply`ã€`replyUser`ã€‚
- **send({ message })**ï¼šä»…å‘é€æ¶ˆæ¯ï¼Œä¸ç­‰å¾…å›å¤ï¼›è¿”å› `messageId`ã€‚

å‚æ•°ä¸è¿”å›å€¼è¯¦è§ [reference.md](./reference.md)ã€‚

## ä½¿ç”¨åœºæ™¯

### 1. å®¡æ‰¹æµç¨‹
```javascript
const result = await notify({
  message: "æ£€æµ‹åˆ°é«˜é£é™©æ“ä½œï¼Œéœ€è¦å®¡æ‰¹\n\næ“ä½œï¼šåˆ é™¤ç”Ÿäº§æ•°æ®åº“\nè¯·å›å¤ã€Œæ‰¹å‡†ã€æˆ–ã€Œæ‹’ç»ã€",
  timeout: 300, // 5åˆ†é’Ÿ
});

if (result.status === "replied" && result.reply === "æ‰¹å‡†") {
  // æ‰§è¡Œæ“ä½œ
}
```

### 2. å¼‚å¸¸å‘Šè­¦
```javascript
await send({
  message: "âš ï¸ æœåŠ¡å™¨ CPU ä½¿ç”¨ç‡è¶…è¿‡ 90%\n\næ—¶é—´: " + new Date().toISOString(),
});
```

### 3. ä»»åŠ¡å®Œæˆé€šçŸ¥
```javascript
await send({
  message: "âœ… æ•°æ®å¤‡ä»½å®Œæˆ\n\næ–‡ä»¶æ•°: 1234\nå¤§å°: 5.6GB",
});
```

### 4. äº¤äº’å¼ç¡®è®¤
```javascript
const result = await notify({
  message: "å‘ç° 3 ä¸ªå¾…å¤„ç†çš„é—®é¢˜ï¼Œæ˜¯å¦ç«‹å³å¤„ç†ï¼Ÿ",
  timeout: 60,
});

if (result.status === "replied" && result.reply.includes("æ˜¯")) {
  // å¤„ç†é—®é¢˜
}
```

## é¦–æ¬¡ä½¿ç”¨ä¸é…ç½®å¼•å¯¼ï¼ˆå‘½ä»¤å†…éƒ¨é€»è¾‘ï¼‰

**ï¼ˆAI å¿…è¯»ï¼‰å½“ç”¨æˆ·è¯´ã€Œåˆ‡åˆ°é£ä¹¦ã€ã€Œåˆ‡æ¢åˆ°é£ä¹¦ã€ã€Œå‘æ¶ˆæ¯åˆ°é£ä¹¦ã€æ—¶ï¼šä½ åªéœ€å¾ªç¯è°ƒç”¨ `npx skill-message-bridge "<å†…å®¹>"`ã€‚** ä¸éœ€è¦å…ˆè·‘ check-envã€å†é€‰ config æˆ– connectï¼›è‡ªæ£€ä¸é…ç½®æ˜¯**å‘½ä»¤å†…éƒ¨é€»è¾‘**ï¼Œæœªé…ç½®æ—¶å‘½ä»¤ä¼šæŠ¥é”™æˆ–æç¤ºï¼Œä½ å†æŒ‰ä¸‹é¢å¼•å¯¼ç”¨æˆ·å³å¯ã€‚

è‹¥è°ƒç”¨ `npx skill-message-bridge "<å†…å®¹>"` å¤±è´¥æˆ–æç¤ºæœªé…ç½®ï¼ŒæŒ‰**ç¼ºé¡¹é¡ºåº**å¼•å¯¼ç”¨æˆ·ï¼ˆä»¥ä¸‹å‡ä¸ºå‘½ä»¤å†…éƒ¨/ç”¨æˆ·ä¾§æ“ä½œï¼Œä¸æ˜¯ä½ å¤šè°ƒå‡ ç§å­å‘½ä»¤ï¼‰ï¼š

- **ç¼ºå°‘ App ID æˆ– App Secret**ï¼šå¼•å¯¼ç”¨æˆ·åˆ° [é£ä¹¦å¼€æ”¾å¹³å°](https://open.feishu.cn/) åˆ›å»ºåº”ç”¨å¹¶å¤åˆ¶å‡­è¯ï¼Œå†è®©ç”¨æˆ·æ‰§è¡Œ `npx skill-message-bridge config set feishu --app-id=xxx --app-secret=xxx` ä¿å­˜ï¼›å®Œæ•´æ­¥éª¤è§ [docs/ONBOARDING-FEISHU.md](./docs/ONBOARDING-FEISHU.md)ã€‚
- **ä»…ç¼º Chat ID**ï¼šéœ€åœ¨é£ä¹¦åå°é…ç½®äº‹ä»¶è®¢é˜…ï¼ˆé•¿è¿æ¥ + `im.message.receive_v1`ï¼‰ï¼Œå†è®©ç”¨æˆ·**åœ¨æœ¬æœºç»ˆç«¯**æ‰§è¡Œ `npx skill-message-bridge connect`ï¼Œåœ¨ç¾¤èŠæˆ–ç§èŠç»™æœºå™¨äººå‘ä¸€æ¡æ¶ˆæ¯åç»ˆç«¯ä¼šè¾“å‡º chat_idï¼Œå†æ‰§è¡Œ `config set feishu --chat-id=oc_xxx` ä¿å­˜ã€‚**connect ä»…æ­¤æ¬¡é…å¯¹ç”¨ï¼Œç”±ç”¨æˆ·æœ¬æœºæ‰§è¡Œï¼ŒAI ä¸è¦ä»£è·‘ï¼›ã€Œåˆ°é£ä¹¦ã€æ—¶åªå¾ªç¯ `npx skill-message-bridge "<å†…å®¹>"`ã€‚**

é…ç½®å®Œæˆåç”¨æˆ·å†è¯´ã€Œåˆ‡åˆ°é£ä¹¦ã€å³å¯æ­£å¸¸å¾ªç¯ä¸Šè¿°å”¯ä¸€å‘½ä»¤ã€‚

- **å…¶ä»– Channelï¼ˆé’‰é’‰/ä¼å¾®ï¼‰**ï¼šå½“å‰æœªå®ç°ï¼Œå¯åˆ° [Issues](https://github.com/hulk-yin/message-bridge/issues) æœç´¢æˆ–æ–°å»ºéœ€æ±‚ã€‚

## ä¼šè¯åˆ‡æ¢åˆ°é£ä¹¦ = é£ä¹¦é•¿å‘¨æœŸå¯¹è¯é—­ç¯

**ï¼ˆAI å¿…è¯»ï¼‰é™¤ç”¨æˆ·æ˜ç¡®å‘å‡ºç»“æŸä¿¡å·ï¼ˆå¦‚åœ¨é£ä¹¦è¯´ã€Œç»“æŸã€ã€Œåˆ‡å›ã€ï¼‰å¤–ï¼Œä¼šè¯æ°¸ä¸ç»“æŸã€‚** å•è½®è¶…æ—¶ã€ä»»åŠ¡å®Œæˆã€é•¿æ—¶é—´æ— å›å¤ç­‰ä»»ä½•åœºæ™¯å‡ä¸ç»“æŸä¼šè¯ï¼›è¶…æ—¶åç”¨å¿ƒè·³æŠŠä¼šè¯é‡æ–°æ‹‰èµ·ï¼Œç»§ç»­ç­‰é£ä¹¦ä¸‹ä¸€æ¡ã€‚

å½“ç”¨æˆ·è¯´**ã€Œä¼šè¯åˆ‡æ¢åˆ°é£ä¹¦ã€**æ—¶ï¼Œè¿›å…¥é•¿å‘¨æœŸå¯¹è¯ï¼šAI çš„è¾“å‡ºå‘åˆ°é£ä¹¦ â†’ é£ä¹¦ç”¨æˆ·å›å¤ â†’ AI åŸºäºå›å¤å†ç”Ÿæˆ â†’ å†å‘é£ä¹¦ï¼Œå¾ªç¯ï¼›**ä»…**åœ¨ç”¨æˆ·è¯´ã€Œç»“æŸã€ã€Œåˆ‡å›ã€æ—¶é€€å‡ºï¼Œä¸è®¾è½®æ•°ä¸Šé™ã€‚

**å”¯ä¸€ç”¨æ³•**ï¼ˆä¸ä¸Šæ–‡ 4.1 ä¸€è‡´ï¼‰ï¼š

```bash
npx skill-message-bridge "<AI çš„å›å¤å†…å®¹>"
npx skill-message-bridge "<å†…å®¹>" --timeout=3600   # å¯é€‰
# è‹¥åœ¨ skill ç›®å½•å†…ï¼šnpm run turn -- "<å†…å®¹>"
```

- æŠŠå†…å®¹å‘åˆ°é£ä¹¦å¹¶ç­‰å¾…ç”¨æˆ·å›å¤ï¼›stdout è¾“å‡ºå•è¡Œ JSONï¼š`{"status":"replied","reply":"ç”¨æˆ·å›å¤", "replyUser":"?", "sessionHint":"..."}`ï¼Œè¶…æ—¶ä¸º `"status":"timeout"`ã€‚
- **sessionHint**ï¼šé€šå¸¸ä¸ºã€Œç”¨æˆ·æœªè¯´ã€Œç»“æŸã€æˆ–ã€Œåˆ‡å›ã€å‰è¯·ç»§ç»­å¾ªç¯å‘æ¶ˆæ¯ï¼Œå‹¿é€€å‡ºé£ä¹¦ä¼šè¯ã€ã€‚**å½“ status ä¸º "timeout" æ—¶**ï¼ŒsessionHint ä¼šæ”¹ä¸ºæ˜ç¡®æŒ‡ä»¤ï¼šã€Œæœ¬è½®è¶…æ—¶ï¼Œè¯·æ‰§è¡Œ npx skill-message-bridge --heartbeat [--timeout=N] é‡æ–°æ‹‰èµ·ä¼šè¯ï¼Œå‹¿é€€å‡ºã€‚ã€è°ƒç”¨æ–¹æŒ‰æ­¤æ‰§è¡Œå³å¯ã€‚
- stderr ä¼šæç¤ºï¼š`[MessageBridge] è¯·æ ¹æ® sessionHint ç»§ç»­å‘ä¸‹ä¸€æ¡æ¶ˆæ¯åˆ°é£ä¹¦ï¼Œå‹¿é€€å‡ºä¼šè¯ã€‚`
- è¶…æ—¶ï¼šé»˜è®¤çº¦ 12 å°æ—¶ï¼ˆæˆ– `FEISHU_TURN_TIMEOUT`ï¼‰ï¼›å¯ç”¨ `--timeout=N` è¦†ç›–ã€‚**å•è½®è¶…æ—¶åæ°¸ä¸é€€å‡º**ï¼šç”¨ **å¿ƒè·³** `npx skill-message-bridge --heartbeat [--timeout=N]` æŠŠä¼šè¯é‡æ–°æ‹‰èµ·ï¼ŒæŒ‚èµ·ç­‰é£ä¹¦ä¸‹ä¸€æ¡ï¼ˆä¸æ¨é€ä»»ä½•å†…å®¹ï¼‰ï¼›æˆ–å‘ã€Œç­‰å¾…è¶…æ—¶ï¼Œå¦‚éœ€ç»§ç»­è¯·ç›´æ¥å›å¤ã€åå†å‘ä¸€æ¡ `"<å†…å®¹>"`ã€‚è¶…æ—¶â‰ ç»“æŸä¼šè¯ã€‚

**é—­ç¯**ï¼šå¾ªç¯ã€ŒAI ç”Ÿæˆå›å¤ â†’ `npx skill-message-bridge "<å†…å®¹>"` â†’ è§£æ replyã€sessionHintï¼›è‹¥æœ¬è½®è¶…æ—¶ â†’ ç”¨ `npx skill-message-bridge --heartbeat [--timeout=N]` é‡æ–°æ‹‰èµ·ä¼šè¯å†ç­‰ â†’ å†ç”Ÿæˆ â†’ å†è°ƒç”¨ã€ã€‚**ä»…å½“ç”¨æˆ·å‘å‡ºæ˜ç¡®ç»“æŸä¿¡å·ï¼ˆå¦‚ã€Œç»“æŸã€ã€Œåˆ‡å›ã€ï¼‰æ—¶é€€å‡ºï¼›ä»»åŠ¡ç»“æŸã€è¶…æ—¶ã€æ— å›å¤ç­‰ä»»ä½•å…¶ä»–åœºæ™¯ä¸€å¾‹ä¸é€€å‡ºã€‚**

**ä¸ºä½•ä¼šè‡ªåŠ¨æ–­æ‰**ï¼šé—­ç¯åœ¨ Cursor å•æ¬¡å›å¤é‡Œè·‘ï¼Œæœ‰å·¥å…·è°ƒç”¨/ä¸Šä¸‹æ–‡ä¸Šé™ï¼Œè·‘ä¸€æ®µæ—¶é—´å°±ä¼šç»“æŸå½“æ¬¡å›å¤ã€‚**è§£å†³**ï¼šè¦ä¸ä¾èµ– Cursor çš„æŒä¹…å¯¹è¯ï¼Œå¯è¿è¡Œå¸¸é©»è¿›ç¨‹ `npm run conversation`ï¼ˆå³ `node scripts/feishu-conversation.js`ï¼Œéœ€é…ç½® AI_REPLY_URL æˆ– OPENAI_API_KEYï¼‰ï¼Œåœ¨é£ä¹¦é‡Œä¸€ç›´èŠç›´åˆ°ä½ è¯´ç»“æŸï¼›è‹¥ç»§ç»­ç”¨ Cursor é—­ç¯ï¼Œæ–­æ‰åè¯´ã€Œç»§ç»­é£ä¹¦ã€å³æ¢å¤ã€‚

## å¯é€‰ï¼šçº¯é£ä¹¦ç«¯å¯¹è¯ï¼ˆscripts/feishu-conversation.jsï¼‰

ä¸ç»è¿‡ Cursorã€åªåœ¨é£ä¹¦é‡Œå’Œæœºå™¨äººå¯¹è¯æ—¶ï¼Œå¯å•ç‹¬è¿è¡Œï¼š

```bash
npm run conversation   # æˆ– node scripts/feishu-conversation.js
```

éœ€é…ç½® **AI_REPLY_URL** æˆ– **OPENAI_API_KEY**ï¼ˆ+ OPENAI_BASE_URLã€OPENAI_MODELï¼‰ã€‚é£ä¹¦éœ€å·²è®¢é˜… `im.message.receive_v1`ï¼ˆé•¿è¿æ¥ï¼‰ã€‚

## æµ‹è¯•

**éªŒè¯å”¯ä¸€ç”¨æ³•**ï¼ˆå‘åˆ°é£ä¹¦å¹¶ç­‰å›å¤ï¼Œéœ€é£ä¹¦ç¾¤å†…æœ‰äººå›ï¼‰ï¼š

```bash
npx skill-message-bridge "è¯·å›å¤æµ‹è¯•"
```

è‡ªæ£€ã€åªå‘ä¸ç­‰ç­‰ä¸ºå‘½ä»¤å†…éƒ¨/è°ƒè¯•ç”¨ï¼ˆè§ Â§4.2ï¼‰ã€‚åœ¨ä»“åº“å†…è¿˜å¯è¿è¡Œï¼š`npm test`ã€`npm run test:quick`ã€`npm run test:complete`ã€`npm run test:session-bridge`ã€‚

## æ›´å¤šå‚è€ƒ

- **API å‚æ•°ä¸è¿”å›å€¼ã€npm å‘å¸ƒä¸éªŒè¯ã€æŠ€æœ¯å®ç°ã€é™åˆ¶ä¸æœªæ¥è®¡åˆ’**ï¼šè§ [reference.md](./reference.md)ã€‚
